"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2414],{92414:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var a=t(60920),s=t(1522),r=t(39299),c=t(56495),o=t(63114),i=t(88804),u=t.n(i),l=t(86527),d=t(45197),g=t(82011),f=t(17564),p=t(48875),v=t(8650),m=t(20021),h=t(96166),Z={container:"container_do0RY","selected-tags":"selected-tags_oQIy4",selectedTags:"selected-tags_oQIy4","passages-container":"passages-container_QzkDw",passagesContainer:"passages-container_QzkDw",card:"card_TJPeX",content:"content_k4jQq",tags:"tags_hKMB5",pagination:"pagination_XtSvB"},j=t(86498),x={pageNo:1,pageSize:24,pageCount:1},N=function(e){var n=e.onEnterPassage,t=e.catalogue,r=(0,s.gz)(x),i=(0,o.Z)(r,2),N=i[0],k=N.pageNo,C=N.pageSize,w=N.pageCount,_=i[1],y=(0,s.s0)(),M=(0,s.e0)(),T=M.onReplaceTags,b=M.onRemoveTag,z=M.tags,R=(0,a.useMemo)((function(){var e=Object.values(t||{});return _({pageCount:Math.ceil(e.length/C)}),e.slice(C*(k-1),C*k).map((function(e){return(0,c.Z)((0,c.Z)({},e),{},{mdate:u()(e.mdate).format("YYYY-MM-DD HH:mm:ss")})}))}),[t,_,C,k]),S=function(e){null===n||void 0===n||n(e),y("/passage/".concat(e["json-path"]))};return(0,j.jsxs)("div",{className:Z.container,children:[!!z.length&&(0,j.jsxs)(d.Z,{className:Z.selectedTags,variant:"outlined",children:[null===z||void 0===z?void 0:z.map((function(e){return(0,j.jsx)(h.Vp,{selected:!0,onRemove:function(){return b(e)},children:e})})),(0,j.jsx)(m.Z,{size:"small",color:"primary",onClick:function(){return T([])},children:"\u6e05\u9664"})]}),(0,j.jsx)("div",{className:Z.passagesContainer,children:R.map((function(e){var n;return(0,j.jsxs)(g.Z,{className:Z.card,variant:"outlined",onClick:function(){return S(e)},children:[(0,j.jsxs)(f.Z,{className:Z.content,children:[(0,j.jsx)(v.Z,{color:"h5",children:e.title}),(0,j.jsx)(v.Z,{color:"text.secondary",children:e.mdate}),(0,j.jsx)("div",{className:Z.tags,children:null===(n=e.tags)||void 0===n?void 0:n.map((function(e){return(0,j.jsx)(h.Vp,{onClick:function(){return T([e])},children:e},e)}))})]}),(0,j.jsx)(p.Z,{className:Z.actions,children:(0,j.jsx)(m.Z,{size:"small",onClick:function(){return S(e)},children:"read..."})})]})}))}),(0,j.jsx)("div",{className:Z.pagination,children:(0,j.jsx)(l.Z,{count:w,page:k,onChange:function(e,n){_({pageNo:n})}})})]})},k=t(12672),C="tags-pool_DOAPN",w="tags_KNxsG",_=function(e){var n=e.tags,t=(0,a.useState)(!1),r=(0,o.Z)(t,2),i=r[0],u=r[1],l=(0,s.e0)(),g=l.onSelectTag,f=l.onRemoveTag,p=l.tags;return(0,a.useLayoutEffect)((function(){setTimeout((function(){u(!0)}),3e3)}),[]),(0,j.jsxs)(d.Z,{className:C,variant:"outlined",children:[(0,j.jsx)(v.Z,{variant:"h3",children:"Tags"}),(0,j.jsx)("div",{className:w,children:Array.from(n).map((function(e,n){var t=(0,o.Z)(e,2),a=t[0],s=t[1];return(0,j.jsx)(k.Z,(0,c.Z)((0,c.Z)({in:i,style:{transformOrigin:"0 0 0"}},i?{timeout:100*n}:{}),{},{children:(0,j.jsxs)(h.Vp,{selected:p.includes(a),onClick:function(){return g(a)},onRemove:function(){return f(a)},children:[a,"(",s.length||0,")"]})}),a)}))})]})},y=t(19565),M=t(8135),T=t(99641),b=t(20810),z={tagsMap:new Map,catalogue:{}};function R(){var e=(0,s.il)(b.Z),n=(0,o.Z)(e,3),t=n[0],r=n[1],i=n[2],u=(0,s.e0)().tags,l=(0,s.gz)(z),d=(0,o.Z)(l,2),g=d[0],f=d[1],p=(0,s.tG)((function(e){return Object.keys(e).reduce((function(n,t){var a,s=e[t];return 0===u.length||null!==(a=s.tags)&&void 0!==a&&a.some((function(e){return u.includes(e)}))?(0,c.Z)((0,c.Z)({},n),{},(0,T.Z)({},t,s)):n}),{})}));return(0,s.bd)((0,M.Z)((0,y.Z)().mark((function e(){var n,a,s;return(0,y.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,a=n.data,s=new Map,Object.values(a).reduce((function(e,n){var t=n.tags;return(void 0===t?[]:t).forEach((function(t){var a=e.get(t)||[];a.push(n),e.set(t,a)})),e}),s),f({tagsMap:s,catalogue:p(a)});case 7:case"end":return e.stop()}}),e)}))),[u.join(","),p,f]),(0,a.useEffect)((function(){var e=(null===r||void 0===r?void 0:r.data)||{};f({catalogue:p(e)})}),[p,null===r||void 0===r?void 0:r.data,f]),(0,c.Z)({loading:i},g)}var S="catalogue_vrzmA",D=function(){var e=(0,s.Gm)().setStates,n=R(),t=n.catalogue,c=n.tagsMap;return(0,a.useEffect)((function(){null===e||void 0===e||e({title:r.TN})}),[e]),(0,j.jsxs)("div",{className:S,children:[(0,j.jsx)(_,{tags:c}),(0,j.jsx)(N,{catalogue:t})]})},E=(0,a.memo)(D)},20810:function(e,n,t){t.d(n,{Z:function(){return o}});var a=t(19565),s=t(8135),r=t(60902),c=t.n(r);function o(){return i.apply(this,arguments)}function i(){return(i=(0,s.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().get("/md/catalogue.json");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);